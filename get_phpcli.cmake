if(EXISTS ${OUTPUT})
  file(SHA256 ${OUTPUT} PHP_EXE_CURRENT_SHA256)
endif()
if(CMAKE_HOST_WIN32)
  if(NOT EXE_HASH_WINDOWS STREQUAL PHP_EXE_CURRENT_SHA256)
    cmake_path(GET URL_WINDOWS FILENAME FNAME)
    cmake_path(APPEND EXTERN_DIR FNAME OUTPUT_VARIABLE ARCH_PATH)
    file(DOWNLOAD "${URL_WINDOWS}" "${ARCH_PATH}" EXPECTED_HASH SHA256=${HASH_WINDOWS})
    file(ARCHIVE_EXTRACT INPUT "${ARCH_PATH}" DESTINATION "${EXTERN_DIR}")
  endif()
else()
  if(NOT EXE_HASH_LINUX STREQUAL PHP_EXE_CURRENT_SHA256)
    cmake_path(GET URL_LINUX FILENAME FNAME)
    cmake_path(APPEND EXTERN_DIR ${FNAME} OUTPUT_VARIABLE ARCH_PATH)
    file(DOWNLOAD "${URL_LINUX}" "${ARCH_PATH}" EXPECTED_HASH SHA256=${HASH_LINUX})
    file(ARCHIVE_EXTRACT INPUT "${ARCH_PATH}" DESTINATION "${EXTERN_DIR}")
    file(RENAME "${EXTERN_DIR}/php" "${EXTERN_DIR}/php.exe")
  endif()
endif()
